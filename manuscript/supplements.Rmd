---
title: "Replikationskrise, Open Science und p-hacking: Die Studierenden"
subtitle: "Ergänzende Materialien"
author: "PsyFaKo Open Science AG"
date: "`r format(Sys.time(), '%d.%m.%Y')`"
output:
  bookdown::word_document2: 
    fig_caption: yes
    reference_docx: supplements-style-reference.docx
    toc: yes
  pdf_document: 
    fig_caption: yes
csl: apa.csl
bibliography: references.bib
lang: de
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

<!-- Hier werden Pakete geladen, die im Dokument benötigt werden. -->
```{r load packages, include=FALSE}
library(tidyverse)
library(knitr)
source("code/helpers/packages.R")
source("code/helpers/helper_functions.R")
source("code/helpers/static.R")
```

<!-- Hier werden Datensätze und R-Objekte importiert, um Daten/Analysen und Plots automatisch einfügen zu können. -->
```{r import data, include=FALSE}
wide <- read_csv("data/wide.csv") %>% only_psych()
wide.emp <- wide %>% filter(emp_experience == "Yes")
long <- read_csv("data/long.csv") %>% only_psych()


ex <- readRDS("data/exploration.rds")
block2 <- readRDS("data/block2_results.rds")
block3 <- readRDS("data/block3_results.rds")
```

```{r global values}
fnt <- "Arial"
fntsz <- 11
lbreak <- ""
tab.counter <- 0
```

```{r observation numbers, include=FALSE}
n.all <- wide %>% nrow()
n.emp <- wide %>% filter(emp_experience == "Yes") %>% nrow()

n.allproj <- long %>% distinct(id, project, project_conducted) %>%
  pull(project_conducted) %>% sum()

n.all_clear_uni <- long %>% 
  filter(project_conducted) %>% 
  filter(uni_project != "_unclear") %>%
  distinct(id) %>% nrow()

n.unclearproj <- long %>% 
  filter(project_conducted) %>% 
  filter(uni_project == "_unclear") %>% 
  distinct(id, project) %>% nrow()

n.illog <- long %>% 
  filter(project_conducted) %>% 
  filter(is.na(rp_applied)) %>% 
  group_by(type_of_practice) %>% summarise(n = sum(illog_answ_subj)) %>% 
  pull(n)
names(n.illog) <- c("Open", "Questionable")

n.obs.qrp <- long %>% filter(project_conducted) %>% 
  filter(type_of_practice == "Questionable") %>% nrow()

n.obs.orp <- long %>% filter(project_conducted) %>% 
  filter(type_of_practice == "Open") %>% nrow()

n_qrp.expra.bsc <- long %>% filter(project_conducted) %>% 
  filter(project %in% c("thesis.bsc", "emp.intern")) %>% 
  filter(type_of_practice == "Questionable")

n_orp.expra.bsc <- long %>% filter(project_conducted) %>% 
  filter(project %in% c("thesis.bsc", "emp.intern")) %>% 
  filter(type_of_practice == "Open")

nproj.qrp.lin <- long %>% filter(project_conducted) %>% 
  filter(type_of_practice == "Questionable") %>% 
  filter(project %in% c("emp.intern", "thesis.bsc", "thesis.msc")) %>% 
  distinct(id, project) %>% nrow()

nproj.orp.lin <- long %>% filter(project_conducted) %>% 
  filter(type_of_practice == "Open") %>% 
  filter(project %in% c("emp.intern", "thesis.bsc", "thesis.msc")) %>% 
  distinct(id, project) %>% nrow()
```


# Ergänzungen zum Methodenteil

```{r}
gender <- wide %>% only_psych() %>% 
  filter(emp_experience == "Yes") %>% 
  group_by(sex) %>% summarise(share = (n() / nrow(.))*100) %>% 
  spread(key = sex, value = share) %>% 
  rename(noanswer = `no answer`)

age <- wide %>% only_psych() %>% 
  filter(emp_experience == "Yes") %>% 
  pull(age)

phase <- wide %>% only_psych() %>% 
  filter(emp_experience == "Yes") %>% 
  group_by(study_stage_mc) %>% summarise(share = (n() / nrow(.))*100) %>% 
  spread(key = study_stage_mc, value = share) %>% 
  rename(alumni = `I don't study (any more)`)

uni.ma <- wide %>% only_psych() %>% 
  filter(emp_experience == "Yes") %>% 
  pull(uni_current) %>% unique()
uni.bsc <- wide %>% only_psych() %>% 
  filter(emp_experience == "Yes") %>% 
  pull(uni_bachelor) %>% unique()

n.uni <- c(uni.ma, uni.bsc) %>% unique() %>% na.omit()

n.uni30 <- sum(!(n.uni %in% as.character(1:50)))

```


**Stichprobenbeschreibung (volle Stichprobe)**. Die Teilnehmer\*innen in dieser Teilstichprobe (weiblich: `r gender$female %>% cop()`; männlich: `r gender$male %>% cop()`; divers: `r gender$diverse %>% cop()`; keine Angabe: `r gender$noanswer %>% cop()`) waren im Mittel `r age %>% mean() %>% co()` Jahre alt (SD = `r age %>% sd() %>% co()`) und Psychologiestudierende in allen Phasen ihres Studiums (s. Abbildung 1). Es nahmen mehr Bachelor- als Masterstudierende teil (`r phase$Bachelor %>% cop()` zu `r phase$Master %>% cop()`). Der Anteil von Alumni/Alumnae war mit `r phase$alumni %>% cop()` gering. In der Stichprobe sind Teilnehmende von `r n.uni %>% length()` deutschsprachigen staatlichen und privaten Hochschulen und Universitäten vertreten. Für `r n.uni30` Hochschulen lagen uns 30 oder mehr Datenpunkte vor.

# Ausführlichere Darstellung der Ergebnisse

## Verbreitung fragwürdiger Forschungspraktiken
```{r}
tab.counter <- tab.counter + 1 # counter increases automatically
tabq01 <- tab.counter # individual counter for table

cap <- "Ausführlichere Darstellung zum Einsatz von Forschungspraktiken nach Typ der Praktik und Art des Projekts. med. = Median, max = Maximum, min = Minimum, n = Anzahl Projekte"

block2$q02 %>% 
  ungroup() %>% 
  mutate(type_of_practice = factor(type_of_practice, 
                                   levels = c("Open", "Questionable"),
                                   labels = c("Positiv", "Fragwürdig"))) %>% 
  rename(`med.` = med,
         min = minimum,
         max = maximum,
         n = n_conducted,
         type = type_of_practice) %>% 
  mutate_at(c(3,4), co, nround = 2, nsmall = 2) %>% 
  mutate_at(7:9, as.character) %>% 
  flextable() %>% 
  flextable::fontsize(size = 10, part = "body") %>% 
  autofit() %>% 
  # width(7:9, width = 0.5) %>% 
  # width(c(5, 6), width = 0.75) %>% 
  set_caption(glue::glue("Tabelle {tab.counter}. {cap}"))
```


## Zusätzliche Ergebnisse



### Thematisierung der Repliaktionskrise - Nach Uni

```{r, echo=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.rct_uni <- tab.counter # individual counter for table

cap <- "Antworten von Studierenden auf die Frage \"Wurde die Replikationskrise  in Lehrveranstaltungen an deiner aktuellen Universität thematisiert?\" nach Universität. Dargestellt sind nur Daten von Universitäten, von denen mindestens 30 Beobachtungen vorlagen"

# a little wasteful workaround to get the correct number of students per
# study stage
tmp <- wide %>% 
           group_by(study_stage_mc) %>% 
           summarise(n = n()) %>% 
  arrange(study_stage_mc) %>% 
  pull(n)

block3$rc_teaching_uni %>% 
  select(uni_current, n_uni, yes.n, no.n, not_sure.n, 
         yes.share, no.share, not_sure.share) %>% 
  rename(Universität = uni_current,
         n = n_uni,
         `Ja` = yes.n,
         `Nein` = no.n,
         `Nicht sicher` = not_sure.n,
         `% Ja` = yes.share,
         `% Nein` = no.share,
         `% Nicht sicher` = not_sure.share) %>% 
  flextable() %>% 
  width(1, width = 2) %>% 
  width(2:4, width = 0.5) %>% 
  align(j = 2:4, align = "center", part = "all") %>% 
  flextable::font(x = ., fontname = fnt, part = "all") %>% 
  flextable::fontsize(size = fntsz, part = "body") %>% 
  set_caption(glue::glue("Tabelle {tab.counter}. {cap}"))
```

### Thematisierung der Repliaktionskrise - Aggregiert

```{r, echo=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.rct <- tab.counter # individual counter for table

cap <- "Anteil von Studierenden im jeweiligen Studienabschnitt, die in einer Lehrveranstaltung an ihrer aktuellen, bzw. letzten (bei Alumni) Universität von der Replikationskrise gehört haben. Die Spalte \"n\" enthält die Größe der jeweiligen Teilstichprobe."

# a little wasteful workaround to get the correct number of students per
# study stage
tmp <- wide %>% 
           group_by(study_stage_mc) %>% 
           summarise(n = n()) %>% 
  arrange(study_stage_mc) %>% 
  pull(n)

block3$rc_teaching_general %>% 
  arrange(study_stage_mc) %>% 
  mutate(n_sum = recode(study_stage_mc, 
                        "Bachelor" = tmp[1], 
                        "I don't study (any more)" = tmp[2], 
                        "Master" = tmp[3], 
                        "Other" = tmp[4])) %>% 
  mutate(rc_teaching = factor(rc_teaching, 
                              levels = c("yes", 
                                         "no", 
                                         "unsure"), 
                              labels = c("Ja", "Nein", "Weiß nicht"))) %>% 
  mutate(study_stage_mc = factor(study_stage_mc,
                                 levels = c("Bachelor", "Master", "Other", 
                                            "I don't study (any more)"),
                                 labels = c("Bachelor", "Master", "Anderer", 
                                            "Studiere nicht (mehr)"))) %>% 
  group_by(rc_teaching, study_stage_mc) %>%
  mutate(n_answer = sum(n, na.rm = T)) %>%
  mutate(share = (n_answer / n_sum) * 100) %>%
  distinct(share, rc_teaching, n_sum) %>%
  select(study_stage_mc, rc_teaching, n_sum, share) %>% 
  arrange(study_stage_mc) %>% 
  mutate(share = share %>% round(1) %>% format(nsmall = 1)) %>% 
  rename(`RK behandelt` = rc_teaching,
         Studienabschnitt = study_stage_mc,
         n = n_sum,
         `Anteil (%)` = share) %>% 
  flextable() %>% 
  autofit() %>% 
  flextable::font(x = ., fontname = fnt, part = "all") %>% 
  set_caption(glue::glue("Tabelle {tab.counter}. {cap}"))
```

### Thematisierung der Repliaktionskrise - Detailliert

```{r, echo=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.rct2 <- tab.counter # individual counter for table

cap <- "Anteil von Studierenden im jeweiligen Studienabschnitt und Semester, die in einer Lehrveranstaltung an ihrer aktuellen, bzw. letzten (bei Alumni) Universität von der Replikationskrise gehört haben. Die Spalte \"n\" enthält die Größe der jeweiligen Teilstichprobe."

block3$rc_teaching_general %>% 
  select(-n) %>% 
  mutate(share = share %>% round(1) %>% format(nsmall = 1)) %>% 
  mutate(rc_teaching = factor(rc_teaching, 
                              levels = c("yes", 
                                         "no", 
                                         "unsure"), 
                              labels = c("Ja", "Nein", "Weiß nicht"))) %>% 
  mutate(study_stage_mc = factor(study_stage_mc,
                                 levels = c("Bachelor", "Master", "Other", 
                                            "I don't study (any more)"),
                                 labels = c("Bachelor", "Master", "Anderer", 
                                            "Studiere nicht (mehr)"))) %>% 
  arrange(study_stage_mc) %>% 
  select(study_stage_mc, semester, rc_teaching, n_semester, share) %>% 
  rename(`RK behandelt` = rc_teaching,
         Semester = semester,
         Studienabschnitt = study_stage_mc,
         n = n_semester,
         `Anteil (%)` = share) %>% 
  flextable() %>% 
  autofit() %>% 
  flextable::font(fontname = fnt, part = "all") %>% 
  set_caption(glue::glue("Tabelle {tab.counter}. {cap}"))
```

<!-- ### Thematisierung der Replikationskrise nach Lehrveranstaltung -->

```{r tab.lectures, eval=FALSE, include=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.rcL <- tab.counter # individual counter for table

cap <- glue::glue("Anteil von Teilnehmenden, die in der jeweiligen Lehrveranstaltung an ihrer aktuellen (Alumni: letzten) Universität eine Thematisierung der Replikationskrise erfahren haben (N = {nrow(wide)}).")

block3$rc_teaching_specific_share %>% 
  mutate(lecture = recode(lecture,
                         "Methods, Stats, Expra" = "Methodenlehre, Statistik, Expra",
                         "Social Psychology" = "Sozialpsychologie",
                         "General Psychology" = "Allgemeine Psychologie",
                         "Introductory Class" = "Einführungsveranstaltung",
                         "Diagnostics" = "Diagnostik",
                         "Differential Psychology" = "Differentielle Psychologie",
                         "Other" = "Andere",
                         "Clinical Psychology" = "Klinische Psychologie",
                         "Biological- / Neuropsychology" = "Biologische / Neuropsychologie",
                         "Work, Organizational and Economic Psychology" = "Arbeits-, Betriebs- und Organisationspsychologie",
                         "Pedagogical Psychology" = "Pädagogische Psychologie",
                         "Developmental Psychology" = "Entwicklungspsychologie",
                         "Health Psychology" = "Gesundheitspsychologie",
                         "Media- / Communication Psychology" = "Medien- / Kommunikationspsychologie",
                         "Forensic" = "Forensische Psychologie")) %>% 
  mutate(share = share %>% co(nround = 1)) %>% 
  rename(`Lehrveranstaltung` = lecture,
         # n = count,
         `Anteil (%)` = share) %>%
  flextable() %>% 
  autofit() %>% 
  flextable::font(fontname = fnt, part = "all") %>% 
  set_caption(glue::glue("Tabelle {tab.counter}. {cap}"))
```


<!-- ### Thematisierung fragwürdiger Forschungspraktiken -->

```{r tab.qrps, eval=FALSE, include=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.rcL <- tab.counter # individual counter for table

cap <- glue::glue("Anteil von Teilnehmenden, die an ihrer aktuellen (bei Alumni: letzten) Universität in mindestens einer Lehrveranstaltung eine kritische Betrachtung der jeweiligen Forschungspraktik erfahren haben (N = {nrow(wide)}).")

block3$qrps_teaching_share %>% 
  mutate(qrp = recode(qrp,
                         "HARKing" = "HARKing",
                         "No Sample Planning" = "Keine Stichprobenplanung",
                         "SR of Variables" = "S.B. von Variablen",
                         "SR of Hypotheses" = "S.B. von Hypothesen",
                         "Flexible Sample Size" = "Flexible Stichprobengröße",
                         "Flexible Exclusion" = "Flexibler Ausschluss von Beob.",
                         "SR of Conditions" = "S.B. von Bedingungen",
                         "Flexible Analysis" = "Flexible Datenanalyse",
                         "Rounding p-Values" = "Runden von p-Werten",
                         "Not Sure" = "Nicht sicher",
                         "None" = "Keine"
                         )) %>% 
  mutate(share = share %>% round(1) %>% format(nsmall = 1)) %>% 
  rename(`Fragwürdige Forschungspraktik` = qrp,
         `Anteil (%)` = share) %>% 
  flextable() %>% 
  autofit() %>% 
  flextable::font(fontname = fnt, part = "all") %>% 
  set_caption(glue::glue("Tabelle {tab.counter}. {cap}"))
```





## Explorative Analysen
### GLMM zu ORPs

```{r GLMM ORPs custom}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.glmm.orp <- tab.counter # individual counter for table
m <- ex$orp$models$m3
pred.names <- na2

# reference levels of categorical data in table
kat <- paste(ref.sex, ref.stage, ref.osi_at_uni, ref.osi, ref.rc, ref.proj, sep = ", ")

# abbreviations used in table
abk.tab <-  paste(abk.rk, abk.osi, abk.qrp, abk.sb, abk.sf, sep = ", ")

# table caption
cap <- "Schätzungen der fixen Effekte für positive Forschungspraktiken. Abhängige Variable: Forschungspraktik angewendet (0 – Nein, 1 – Ja). Zufällige Achsenabschnitte: Für Teilnehmende, die mit einem Projekt jeweils assoziierte Universität und die spezifische Forschungspraktik."
```

```{r GLMM ORPs automatic}
d <- m %>% model.frame() %>% as_tibble() # 'raw' data for this table
t <- m %>% glmer_table(names = pred.names) # table data

a0 <- t$alpha # used alpha level
a <-  a0 %>% quick.p()
b <- ifelse(a0[1] == 0.05, "", " (adjustierte Alpha-Niveaus nach Bonferroni)")
p_exp <- glue("Markierungen: * p < {a[1]}, ** p < {a[2]}, *** p < {a[3]}{b}")

n.obsx <- d %>% nrow(); n.obs <- n.obsx %>% format(big.mark = ' ')
n.projx <- d %>% distinct(id, project) %>% nrow()
n.proj <- n.projx %>% format(big.mark = ' ')
n.subjx <- d %>% distinct(id) %>% nrow()
n.subj <- n.subjx  %>% format(big.mark = ' ')
n <- glue("Datenpunkte insg. = {n.obs}, Projekte = {n.proj}, Teilnehmende = {n.subj}")

ref <- paste0("Referenzkategorien: ", kat, ".\n")
abk <- abk.f(abk.glmer, abk.tab)
```

Welche Faktoren beeinflussen den Einsatz von ORPs?

#### Ausschluss von Beobachtungen
Einzelne Beobachtungen wurden wegen inkonsistenter Antworten oder unklarer Zuordnung des jeweiligen Projektes zu einer Universität ausgeschlossen. Ersteres geschah in Fällen, in denen Teilnehmende bei der Frage nach der Anwendung einer spezifischen Forschungspraktik sowohl die Antwortmöglichkeit "Keines" (Praktik in keinem Projekt verwendet), als auch ein oder mehrere Projekte auswählen (bei offenen Praktiken n = `r n.illog[1]` Beobachtungen). Zweiteres geschah bei den Projekten "Projektarbeit" und "Anderes", wenn die Teilnehmenden ihre Universität zwischen Bachelor und Master gewechselt hatten, oder bei Alumni/Alumnae, da deren Bachelor-Universität nicht erfasst wurde (n = `r n.unclearproj`). Zwischen beiden Kriterien gab es Überschneidungen. Insgesamt werden so `r n.obs.orp - n.obsx` Datenpunkte zu `r n.allproj - n.projx` Projekten von `r n.emp - n.subjx` Teilnehmenden in der Analyse nicht berichtet.

```{r GLMM ORPs Table}
t$table %>% 
  select(-1) %>% 
  mutate_at(c(2, 3, 4, 6), co) %>% 
  flextable() %>% 
  align(j = c(1, 7), align = "left", part = "body") %>% 
  align(j = c(1, 7), align= "left", part = "header") %>% 
  autofit() %>% 
  add_footer_lines(c(glue("Anmerkungen. {n}"), ref, abk, p_exp)) %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  flextable::font(fontname = fnt, part = "all") %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  identity()
```

### GLMM zu rezenten Projekten, QRPs


```{r GLMM recent QRPs custom, include=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.recent.qrp <- tab.counter # individual counter for table
m <- ex$recent.qrp$models$m2
pred.names <- na3
m %>% summary()

# reference levels of categorical data in table
kat <- paste(ref.stage, ref.proj, sep = ", ")

# abbreviations used in table
abk.tab <-  paste(abk.sf, sep = ", ")

# table caption
cap <- "Schätzungen der fixen Effekte für fragwürdige Forschungspraktiken. Abhängige Variable: Forschungspraktik angewendet (0 – Nein, 1 – Ja). Zufällige Achsenabschnitte: Für Teilnehmende und die mit einem Projekt jeweils assoziierte Universität."
```

```{r GLMM recent QRPs automatic}
d <- m %>% model.frame() %>% as_tibble() # 'raw' data for this table
t <- m %>% glmer_table(names = pred.names) # table data

a0 <- t$alpha # used alpha level
a <-  a0 %>% quick.p()
b <- ifelse(a0[1] == 0.05, "", " (adjustierte Alpha-Niveaus nach Bonferroni)")
p_exp <- glue("Markierungen: * p < {a[1]}, ** p < {a[2]}, *** p < {a[3]}{b}")

n.obsx <- d %>% nrow(); n.obs <- n.obsx %>% format(big.mark = ' ')
n.projx <- d %>% distinct(id, project) %>% nrow()
n.proj <- n.projx %>% format(big.mark = ' ')
n.subjx <- d %>% distinct(id) %>% nrow()
n.subj <- n.subjx  %>% format(big.mark = ' ')
n <- glue("Datenpunkte insg. = {n.obs}, Projekte = {n.proj}, Teilnehmende = {n.subj}")

ref <- paste0("Referenzkategorien: ", kat, ".\n")
abk <- abk.f(abk.glmer, abk.tab)
```

Gibt es zwischen aktuellen Master- und aktuellen Bachelor-Studierenden Unterschiede in der Wahrscheinlichkeit, mit der QRPs angewendet wurden? Wenn ja, ist das ein Hinweis darauf, dass es in der näheren Vergangenheit Veränderungen in der Lehre gab.
Hier nur Betrachtung von Expras und Bachelorarbeiten.

#### Ausschluss von Beobachtungen
Einzelne Beobachtungen wurden wegen inkonsistenter Antworten oder unklarer Zuordnung des jeweiligen Projektes zu einer Universität ausgeschlossen. Ersteres geschah in Fällen, in denen Teilnehmende bei der Frage nach der Anwendung einer spezifischen Forschungspraktik sowohl die Antwortmöglichkeit "Keines" (Praktik in keinem Projekt verwendet), als auch ein oder mehrere Projekte auswählen (bei offenen Praktiken n = `r n.illog[1]` Beobachtungen). Zweiteres geschah bei den Projekten "Projektarbeit" und "Anderes", wenn die Teilnehmenden ihre Universität zwischen Bachelor und Master gewechselt hatten, oder bei Alumni/Alumnae, da deren Bachelor-Universität nicht erfasst wurde (n = `r n.unclearproj`). Des Weiterern wurden nur Daten von Expras und Bachelorarbeiten berücksichtigt (n = `r n_qrp.expra.bsc %>% distinct(id, project) %>% nrow()` Projekte). Insgesamt werden so `r n.obs.qrp - n.obsx` Datenpunkte zu `r n.allproj - n.projx` Projekten von `r n.emp - n.subjx` Teilnehmenden in der Analyse nicht berichtet. Zwischen den Kriterien gab es Überschneidungen.

```{r GLMM recent QRPs Table}
t$table %>% 
  select(-1) %>% 
  mutate_at(c(2, 3, 4, 6), co) %>% 
  flextable() %>% 
  align(j = c(1, 7), align = "left", part = "body") %>% 
  align(j = c(1, 7), align= "left", part = "header") %>% 
  autofit() %>% 
  add_footer_lines(c(glue("Anmerkungen. {n}"), ref, abk, p_exp)) %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  width(1, width = 2) %>%
  width(c(2,3,4,6, 7), width = 0.75) %>%
  width(5, width = 1) %>%
  flextable::font(fontname = fnt, part = "all") %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  identity()
```


### GLMM zu rezenten Projekten, ORPs


```{r GLMM recent ORPs custom, include=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.recent.orp <- tab.counter # individual counter for table
m <- ex$recent.orp$models$m2
pred.names <- na3
m %>% summary()

# reference levels of categorical data in table
kat <- paste(ref.stage, ref.proj, sep = ", ")

# abbreviations used in table
abk.tab <-  paste(abk.sf, sep = ", ")

# table caption
cap <- "Schätzungen der fixen Effekte für offene Forschungspraktiken. Abhängige Variable: Forschungspraktik angewendet (0 – Nein, 1 – Ja). Zufällige Achsenabschnitte: Für Teilnehmende und die mit einem Projekt jeweils assoziierte Universität."
```

```{r GLMM recent ORPs automatic}
d <- m %>% model.frame() %>% as_tibble() # 'raw' data for this table
t <- m %>% glmer_table(names = pred.names) # table data

a0 <- t$alpha # used alpha level
a <-  a0 %>% quick.p()
b <- ifelse(a0[1] == 0.05, "", " (adjustierte Alpha-Niveaus nach Bonferroni)")
p_exp <- glue("Markierungen: * p < {a[1]}, ** p < {a[2]}, *** p < {a[3]}{b}")

n.obsx <- d %>% nrow(); n.obs <- n.obsx %>% format(big.mark = ' ')
n.projx <- d %>% distinct(id, project) %>% nrow()
n.proj <- n.projx %>% format(big.mark = ' ')
n.subjx <- d %>% distinct(id) %>% nrow()
n.subj <- n.subjx  %>% format(big.mark = ' ')
n <- glue("Datenpunkte insg. = {n.obs}, Projekte = {n.proj}, Teilnehmende = {n.subj}")

ref <- paste0("Referenzkategorien: ", kat, ".\n")
abk <- abk.f(abk.glmer, abk.tab)
```

Gibt es zwischen aktuellen Master- und aktuellen Bachelor-Studierenden Unterschiede in der Wahrscheinlichkeit, mit der positive Forschungspraktiken angewendet wurden? Wenn ja, ist das ein Hinweis darauf, dass es Veränderungen in der Lehre gab.

#### Ausschluss von Beobachtungen
Einzelne Beobachtungen wurden wegen inkonsistenter Antworten oder unklarer Zuordnung des jeweiligen Projektes zu einer Universität ausgeschlossen. Ersteres geschah in Fällen, in denen Teilnehmende bei der Frage nach der Anwendung einer spezifischen Forschungspraktik sowohl die Antwortmöglichkeit "Keines" (Praktik in keinem Projekt verwendet), als auch ein oder mehrere Projekte auswählen (bei offenen Praktiken n = `r n.illog[1]` Beobachtungen). Zweiteres geschah bei den Projekten "Projektarbeit" und "Anderes", wenn die Teilnehmenden ihre Universität zwischen Bachelor und Master gewechselt hatten, oder bei Alumni/Alumnae, da deren Bachelor-Universität nicht erfasst wurde (n = `r n.unclearproj`). Des Weiterern wurden nur Daten von Expras und Bachelorarbeiten berücksichtigt (n = `r n_orp.expra.bsc %>% distinct(id, project) %>% nrow()` Projekte). Insgesamt werden so `r n.obs.orp - n.obsx` Datenpunkte zu `r n.allproj - n.projx` Projekten von `r n.emp - n.subjx` Teilnehmenden in der Analyse nicht berichtet. Zwischen den Kriterien gab es Überschneidungen.

```{r GLMM recent ORPs Table}
t$table %>% 
  select(-1) %>% 
  mutate_at(c(2, 3, 4, 6), co) %>% 
  flextable() %>% 
  align(j = c(1, 7), align = "left", part = "body") %>% 
  align(j = c(1, 7), align= "left", part = "header") %>% 
  autofit() %>% 
  add_footer_lines(c(glue("Anmerkungen. {n}"), ref, abk, p_exp)) %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  width(1, width = 2) %>%
  width(c(2,3,4,6, 7), width = 0.75) %>%
  width(5, width = 1) %>%
  flextable::font(fontname = fnt, part = "all") %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  identity()
```


### GLMM linearer Trend der Projektart, QRPs


```{r GLMM linear QRPs custom, include=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.lin.qrp <- tab.counter # individual counter for table
m <- ex$lin.qrp$models$m3
pred.names <- na4a
m %>% summary()

# reference levels of categorical data in table
kat <- paste(ref.stage, ref.proj, sep = ", ")

# abbreviations used in table
abk.tab <-  paste(abk.sf, sep = ", ")

# table caption
cap <- "Modell zur Untersuchung des linearen Trends der Projektart. Schätzungen der fixen Effekte für fragwürdige Forschungspraktiken. Abhängige Variable: Forschungspraktik angewendet (0 – Nein, 1 – Ja). Zufällige Achsenabschnitte: Für Teilnehmende und die mit einem Projekt jeweils assoziierte Universität und die spezifische Forschungspraktik."
```

```{r GLMM linear QRPs automatic}
d <- m %>% model.frame() %>% as_tibble() # 'raw' data for this table
t <- m %>% glmer_table(names = pred.names) # table data

a0 <- t$alpha # used alpha level
a <-  a0 %>% quick.p()
b <- ifelse(a0[1] == 0.05, "", " (adjustierte Alpha-Niveaus nach Bonferroni)")
p_exp <- glue("Markierungen: * p < {a[1]}, ** p < {a[2]}, *** p < {a[3]}{b}")

n.obsx <- d %>% nrow(); n.obs <- n.obsx %>% format(big.mark = ' ')
n.projx <- d %>% distinct(id, project) %>% nrow()
n.proj <- n.projx %>% format(big.mark = ' ')
n.subjx <- d %>% distinct(id) %>% nrow()
n.subj <- n.subjx  %>% format(big.mark = ' ')
n <- glue("Datenpunkte insg. = {n.obs}, Projekte = {n.proj}, Teilnehmende = {n.subj}")

ref <- paste0("Referenzkategorien: ", kat, ".\n")
abk <- abk.f(abk.glmer, abk.tab)
```

Gibt es einen Trend dahingehend, dass bei Projekten, die später im Studium durchgeführt werden, weniger oder mehr QRPs eingesetzt werden?
Hier nur Betrachtung von Expras, Bachelorarbeiten und Masterarbeiten, da für diese die Reihenfolge klar bestimmt werden kann.

#### Ausschluss von Beobachtungen
Einzelne Beobachtungen wurden wegen inkonsistenter Antworten oder unklarer Zuordnung des jeweiligen Projektes zu einer Universität ausgeschlossen. Ersteres geschah in Fällen, in denen Teilnehmende bei der Frage nach der Anwendung einer spezifischen Forschungspraktik sowohl die Antwortmöglichkeit "Keines" (Praktik in keinem Projekt verwendet), als auch ein oder mehrere Projekte auswählen (bei offenen Praktiken n = `r n.illog[1]` Beobachtungen). Zweiteres geschah bei den Projekten "Projektarbeit" und "Anderes", wenn die Teilnehmenden ihre Universität zwischen Bachelor und Master gewechselt hatten, oder bei Alumni/Alumnae, da deren Bachelor-Universität nicht erfasst wurde (n = `r n.unclearproj`). Des Weiterern wurden nur Daten von Expras, Bachelorarbeiten und Masterarbeiten berücksichtigt (n = `r nproj.qrp.lin` Projekte). Insgesamt werden so `r n.obs.qrp - n.obsx` Datenpunkte zu `r n.allproj - n.projx` Projekten von `r n.emp - n.subjx` Teilnehmenden in der Analyse nicht berichtet. Zwischen den Kriterien gab es Überschneidungen.

```{r GLMM linear QRPs Table}
t$table %>% 
  select(-1) %>% 
  mutate_at(c(2, 3, 4, 6), co) %>% 
  flextable() %>% 
  align(j = c(1, 7), align = "left", part = "body") %>% 
  align(j = c(1, 7), align= "left", part = "header") %>% 
  autofit() %>% 
  add_footer_lines(c(glue("Anmerkungen. {n}"), ref, abk, p_exp)) %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  width(1, width = 2) %>%
  width(c(2,3,4,6, 7), width = 0.75) %>%
  width(5, width = 1) %>%
  flextable::font(fontname = fnt, part = "all") %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  identity()
```

### GLMM linearer Trend der Projektart, ORPs


```{r GLMM linear ORPs custom, include=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.lin.orp <- tab.counter # individual counter for table
m <- ex$lin.orp$models$m3
pred.names <- na4b
m %>% summary()

# reference levels of categorical data in table
kat <- paste(ref.stage, ref.proj, sep = ", ")

# abbreviations used in table
abk.tab <-  paste(abk.sf, sep = ", ")

# table caption
cap <- "Modell zur Untersuchung des linearen Trends der Projektart. Schätzungen der fixen Effekte für prositive Forschungspraktiken. Abhängige Variable: Forschungspraktik angewendet (0 – Nein, 1 – Ja). Zufällige Achsenabschnitte: Für Teilnehmende und die mit einem Projekt jeweils assoziierte Universität und die spezifische Forschungspraktik."
```

```{r GLMM linear ORPs automatic}
d <- m %>% model.frame() %>% as_tibble() # 'raw' data for this table
t <- m %>% glmer_table(names = pred.names) # table data

a0 <- t$alpha # used alpha level
a <-  a0 %>% quick.p()
b <- ifelse(a0[1] == 0.05, "", " (adjustierte Alpha-Niveaus nach Bonferroni)")
p_exp <- glue("Markierungen: * p < {a[1]}, ** p < {a[2]}, *** p < {a[3]}{b}")

n.obsx <- d %>% nrow(); n.obs <- n.obsx %>% format(big.mark = ' ')
n.projx <- d %>% distinct(id, project) %>% nrow()
n.proj <- n.projx %>% format(big.mark = ' ')
n.subjx <- d %>% distinct(id) %>% nrow()
n.subj <- n.subjx  %>% format(big.mark = ' ')
n <- glue("Datenpunkte insg. = {n.obs}, Projekte = {n.proj}, Teilnehmende = {n.subj}")

ref <- paste0("Referenzkategorien: ", kat, ".\n")
abk <- abk.f(abk.glmer, abk.tab)
```

Gibt es einen Trend dahingehend, dass bei Projekten, die später im Studium durchgeführt werden, weniger oder mehr ORPs eingesetzt werden?
Hier nur Betrachtung von Expras, Bachelorarbeiten und Masterarbeiten, da für diese die Reihenfolge klar bestimmt werden kann.

#### Ausschluss von Beobachtungen
Einzelne Beobachtungen wurden wegen inkonsistenter Antworten oder unklarer Zuordnung des jeweiligen Projektes zu einer Universität ausgeschlossen. Ersteres geschah in Fällen, in denen Teilnehmende bei der Frage nach der Anwendung einer spezifischen Forschungspraktik sowohl die Antwortmöglichkeit "Keines" (Praktik in keinem Projekt verwendet), als auch ein oder mehrere Projekte auswählen (bei offenen Praktiken n = `r n.illog[1]` Beobachtungen). Zweiteres geschah bei den Projekten "Projektarbeit" und "Anderes", wenn die Teilnehmenden ihre Universität zwischen Bachelor und Master gewechselt hatten, oder bei Alumni/Alumnae, da deren Bachelor-Universität nicht erfasst wurde (n = `r n.unclearproj`). Des Weiterern wurden nur Daten von Expras, Bachelorarbeiten und Masterarbeiten berücksichtigt (n = `r nproj.orp.lin` Projekte). Insgesamt werden so `r n.obs.orp - n.obsx` Datenpunkte zu `r n.allproj - n.projx` Projekten von `r n.emp - n.subjx` Teilnehmenden in der Analyse nicht berichtet. Zwischen den Kriterien gab es Überschneidungen.

```{r GLMM linear ORPs Table}
t$table %>% 
  select(-1) %>% 
  mutate_at(c(2, 3, 4, 6), co) %>% 
  flextable() %>% 
  align(j = c(1, 7), align = "left", part = "body") %>% 
  align(j = c(1, 7), align= "left", part = "header") %>% 
  autofit() %>% 
  add_footer_lines(c(glue("Anmerkungen. {n}"), ref, abk, p_exp)) %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  width(1, width = 2) %>%
  width(c(2,3,4,6, 7), width = 0.75) %>%
  width(5, width = 1) %>%
  flextable::font(fontname = fnt, part = "all") %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  identity()
```


### GLMM Behandlung der RK in der Lehre

```{r GLMM rc in teaching custom, include=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.rc_teaching <- tab.counter # individual counter for table
m <- ex$specific$models$m2
pred.names <- na5
d <- ex$data$specific
m %>% summary()

# reference levels of categorical data in table
kat <- paste(ref.sex, ref.stage, ref.osi_at_uni, ref.osi, sep = ", ")

# abbreviations used in table
abk.tab <-  paste(abk.sf, abk.osi, sep = ", ")

# table caption
cap <- "Modell zur Untersuchung von Zusammenhängen der Kovariaten mit dem Bericht über eine Behandlung der Replikationskrise in Lehrveranstaltungen. Schätzungen der fixen Effekte. Abhängige Variable:  (0 – Nein, 1 – Ja). Zufälliger Achsenabschnitt für Teilnehmende."
```

```{r GLMM rc in teaching ORPs automatic}
t <- m %>% glmer_table(names = pred.names) # table data

a0 <- t$alpha # used alpha level
a <-  a0 %>% quick.p()
b <- ifelse(a0[1] == 0.05, "", " (adjustierte Alpha-Niveaus nach Bonferroni)")
p_exp <- glue("Markierungen: * p < {a[1]}, ** p < {a[2]}, *** p < {a[3]}{b}")

n.subjx <- d %>% distinct(id) %>% nrow()
n.subj <- n.subjx  %>% format(big.mark = ' ')
n <- glue("N = {n.subj}")

ref <- paste0("Referenzkategorien: ", kat, ".\n")
abk <- abk.f(abk.glmer, abk.tab)
```

Welche Faktoren hängen mit der Behandlung der RK in der Lehre zusammen? Ist es gar so, dass Open Science Initiativen dafür sorgen, dass die Behandlung in der Lehre wahrscheinlicher wird?

```{r GLMM rc in teaching ORPs Table}
t$table %>% 
  select(-1) %>% 
  mutate_at(c(2, 3, 4, 6), co) %>% 
  flextable() %>% 
  align(j = c(1, 7), align = "left", part = "body") %>% 
  align(j = c(1, 7), align= "left", part = "header") %>% 
  autofit() %>% 
  add_footer_lines(c(glue("Anmerkungen. {n}"), ref, abk, p_exp)) %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  width(1, width = 2) %>%
  width(c(2,3,4,6, 7), width = 0.75) %>%
  width(5, width = 1) %>%
  flextable::font(fontname = fnt, part = "all") %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  identity()
```

### LMER Eindruck von Informiertheit

```{r LMER feeling informed custom, include=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.inf <- tab.counter # individual counter for table
m <- ex$inf$models$m2
pred.names <- na6
d <- ex$data$att
m %>% summary()

# reference levels of categorical data in table
kat <- paste(ref.sex, ref.stage, ref.osi_at_uni, ref.osi, ref.rc, sep = ", ")

# abbreviations used in table
abk.tab <-  paste(abk.sf, abk.osi, abk.rk, sep = ", ")

# table caption
cap <- "Modell zur Untersuchung von Zusammenhängen der Kovariaten mit dem Eindruck der Teilnehmenden, wie gut sie über den Themenkomplex 'Replikationskrise und Open Science' informiert sind. Schätzungen der fixen Effekte. Abhängige Variable:  Eindruck von Informiertheit (numerisch, min: 1 (gar nicht), max: 5 (sehr), z-standardisiert). Zufälliger Achsenabschnitt für die aktuelle/letzte Universität."
```

```{r LMER feeling informed automatic}
t <- m %>% lmer_table(names = pred.names) # table data

a0 <- t$alpha # used alpha level
a <-  a0 %>% quick.p()
b <- ifelse(a0[1] == 0.05, "", " (adjustierte Alpha-Niveaus nach Bonferroni)")
p_exp <- glue("Markierungen: * p < {a[1]}, ** p < {a[2]}, *** p < {a[3]}{b}")

n.subjx <- d %>% distinct(id) %>% nrow()
n.subj <- n.subjx  %>% format(big.mark = ' ')
n <- glue("N = {n.subj}")

ref <- paste0("Referenzkategorien: ", kat, ".\n")
abk <- abk.f(abk.glmer, abk.tab)
```

Welche Faktoren hängen damit zusammen, ob Studierende sich über den Themenkomplex gut informiert fühlen?

```{r LMER feeling informed table}
t$table %>% 
  select(-1) %>% 
  mutate_at(2:4, co) %>% 
  flextable() %>% 
  align(j = c(1, 5), align = "left", part = "body") %>% 
  align(j = c(1, 5), align= "left", part = "header") %>% 
  # autofit() %>% 
  add_footer_lines(c(n, ref, abk, p_exp)) %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  width(1, width = 2) %>%
  width(c(2,3,4,5), width = 1) %>%
  # width(5, width = 1) %>%
  flextable::font(fontname = fnt, part = "all") %>% 
  identity()
```


### LMER Wichtigkeit

```{r LMER importance custom, include=FALSE}
tab.counter <- tab.counter + 1 # counter increases automatically
tab.imp <- tab.counter # individual counter for table
m <- ex$imp$models$m2
pred.names <- na6
d <- ex$data$att
m %>% summary()

# reference levels of categorical data in table
kat <- paste(ref.sex, ref.stage, ref.osi_at_uni, ref.osi, ref.rc, sep = ", ")

# abbreviations used in table
abk.tab <-  paste(abk.sf, abk.osi, abk.rk, sep = ", ")

# table caption
cap <- "Modell zur Untersuchung von Zusammenhängen der Kovariaten mit der Angabe der Teilnehmenden, als wie wichtig sie den Themenkomplex 'Replikationskrise und Open Science' einschätzen. Schätzungen der fixen Effekte. Abhängige Variable:  Eindruck von Informiertheit (numerisch, min: 1 (gar nicht), max: 5 (sehr), z-standardisiert). Zufälliger Achsenabschnitt für die aktuelle/letzte Universität."
```

```{r LMER importance automatic}
t <- m %>% lmer_table(names = pred.names) # table data

a0 <- t$alpha # used alpha level
a <-  a0 %>% quick.p()
b <- ifelse(a0[1] == 0.05, "", " (adjustierte Alpha-Niveaus nach Bonferroni)")
p_exp <- glue("Markierungen: * p < {a[1]}, ** p < {a[2]}, *** p < {a[3]}{b}")

n.subjx <- d %>% distinct(id) %>% nrow()
n.subj <- n.subjx  %>% format(big.mark = ' ')
n <- glue("N = {n.subj}")

ref <- paste0("Referenzkategorien: ", kat, ".\n")
abk <- abk.f(abk.glmer, abk.tab)
```

Welche Faktoren hängen damit zusammen, ob Studierende den Themenkomplex wichtig finden?

```{r LMER importance table}
t$table %>% 
  select(-1) %>% 
  mutate_at(2:4, co) %>% 
  flextable() %>% 
  align(j = c(1, 5), align = "left", part = "body") %>% 
  align(j = c(1, 5), align= "left", part = "header") %>% 
  # autofit() %>% 
  add_footer_lines(c(n, ref, abk, p_exp)) %>% 
  set_caption(glue("Tabelle {tab.counter}. {cap}")) %>% 
  width(1, width = 2) %>%
  width(c(2,3,4,5), width = 1) %>%
  # width(5, width = 1) %>%
  flextable::font(fontname = fnt, part = "all") %>% 
  identity()
```